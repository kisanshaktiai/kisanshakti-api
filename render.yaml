services:
  # ğŸŒ± FastAPI Web Service
  - type: web
    name: kisanshakti-soil-api
    env: python
    plan: free
    buildCommand: pip install -r requirements.txt
    startCommand: python app.py
    envVars:
      - key: GOOGLE_APPLICATION_CREDENTIALS
        value: credentials.json
      - fromGroup: api-env   # ğŸ‘ˆ attach your existing API env group

  # ğŸ›°ï¸ Tile Fetch Worker (Cron Job)
  - type: cron
    name: tile-fetch-worker
    env: python
    plan: free
    buildCommand: pip install -r requirements.txt
    startCommand: python tile_fetch_worker.py
    schedule: "0 20 * * *"  # runs every day at 2 AM IST (20:00 UTC)
    envVars:
      - fromGroup: sentinel-fetch-env  # ğŸ‘ˆ attach worker env group
